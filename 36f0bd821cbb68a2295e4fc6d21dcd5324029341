Some refactorings.
Various naming indecisiveness.
Added more labels.
Thinking about passes and allocation.
